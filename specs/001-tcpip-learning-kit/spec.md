# Feature Specification: TCP/IP Learning Kit

**Feature Branch**: `001-tcpip-learning-kit`
**Created**: 2026-01-31
**Status**: Draft
**Input**: User description: "TCP/IP通信をプログラムを動かしながら理解するための教育プロジェクト"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 初めてのTCP接続体験 (Priority: P1)

プログラミング初心者が、サーバーとクライアントの基本的な通信を体験する。エコーサーバー（送ったメッセージをそのまま返すサーバー）を動かし、クライアントからメッセージを送信して返答を受け取る。

**Why this priority**: TCP/IP通信の最も基本的な概念（接続、送信、受信、切断）を理解することが、以降のすべての学習の土台となる。

**Independent Test**: サーバーを起動し、クライアントから「Hello」と送信して「Hello」が返ってくることを確認できる。

**Acceptance Scenarios**:

1. **Given** エコーサーバーが起動している状態, **When** クライアントが「Hello」と送信する, **Then** サーバーから「Hello」が返ってくる
2. **Given** エコーサーバーが起動している状態, **When** クライアントが接続を終了する, **Then** サーバーは次の接続を待ち受ける
3. **Given** サーバーが起動していない状態, **When** クライアントが接続を試みる, **Then** わかりやすいエラーメッセージが表示される

---

### User Story 2 - 双方向メッセージングの理解 (Priority: P2)

学習者が、サーバーとクライアント間で双方向にメッセージをやり取りできるシンプルなチャットを体験する。これにより、非同期通信とメッセージの順序について学ぶ。

**Why this priority**: 双方向通信は実際のアプリケーション（チャット、ゲーム等）の基礎であり、P1の概念を発展させる自然な次のステップ。

**Independent Test**: 2つのターミナルでサーバーとクライアントを起動し、双方からメッセージを送り合えることを確認できる。

**Acceptance Scenarios**:

1. **Given** サーバーとクライアントが接続している状態, **When** クライアントがメッセージを送信する, **Then** サーバー側にメッセージが表示される
2. **Given** サーバーとクライアントが接続している状態, **When** サーバーがメッセージを送信する, **Then** クライアント側にメッセージが表示される

---

### User Story 3 - Wiresharkによるパケット解析体験 (Priority: P3)

学習者が、Wiresharkを使ってTCP/IP通信の内部で何が起きているかを視覚的に理解する。3ウェイハンドシェイク、データパケット、FINパケットなどの実際のTCPの動作をキャプチャして解析できる。

**Why this priority**: Wiresharkは業界標準のパケット解析ツールであり、実際のネットワークエンジニアリングで使われるスキルを習得できる。抽象的な概念を具体的なパケットとして確認することで、TCP/IPの理解が深まる。

**Independent Test**: サーバーとクライアント間の通信をWiresharkでキャプチャし、3ウェイハンドシェイク（SYN → SYN-ACK → ACK）を確認できる。

**Acceptance Scenarios**:

1. **Given** Wiresharkがローカルホストをキャプチャしている状態, **When** クライアントがサーバーに接続する, **Then** 3ウェイハンドシェイク（SYN, SYN-ACK, ACK）が確認できる
2. **Given** Wiresharkがキャプチャしている状態, **When** メッセージを送受信する, **Then** PSH-ACKパケットとペイロードの内容が確認できる
3. **Given** Wiresharkがキャプチャしている状態, **When** 接続を終了する, **Then** 4ウェイハンドシェイク（FIN-ACK）が確認できる

---

### Edge Cases

- サーバーが予期せず終了した場合、クライアントにわかりやすいエラーメッセージを表示する
- 不正なポート番号が指定された場合、適切なエラーメッセージを表示する
- 同じポートで複数のサーバーを起動しようとした場合、わかりやすいエラーメッセージを表示する

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 各レッスンはコンパイルして即座に実行できなければならない（MUST）
- **FR-002**: 各レッスンに実行方法と期待される出力を記載したREADMEを含めなければならない（MUST）
- **FR-003**: エラーメッセージは日本語で、原因と対処法を含めなければならない（MUST）
- **FR-004**: ソースコードには各行の役割を説明するコメントを含めなければならない（MUST）
- **FR-005**: レッスンは番号順に段階的な難易度で構成しなければならない（MUST）
- **FR-006**: 外部ライブラリに依存せず、標準ライブラリのみで実装しなければならない（MUST）
- **FR-007**: Linux環境で動作しなければならない（MUST）
- **FR-008**: Wiresharkでのパケット解析手順を記載したガイドを含めなければならない（MUST）
- **FR-009**: Wireshark用のフィルタ例（ポート番号指定など）をドキュメントに含めなければならない（MUST）

### Key Entities

- **Lesson（レッスン）**: 1つの概念を学ぶための独立した学習単位。ソースコード、README、期待される出力を含む
- **Server（サーバー）**: 接続を待ち受け、クライアントからのリクエストを処理するプログラム
- **Client（クライアント）**: サーバーに接続し、メッセージを送受信するプログラム

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: TCP/IP未経験者が、READMEを読むだけで各レッスンを実行できる
- **SC-002**: 各レッスンのビルドと実行が1分以内に完了する
- **SC-003**: すべてのレッスンが、指定されたLinux環境で正常に動作する
- **SC-004**: 学習者が各レッスン完了後、そのレッスンで学んだ概念を説明できる
